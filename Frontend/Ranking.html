<html>
    <head>
        <title>Ranking enkelcompetitie</title>
        <link rel="stylesheet" href="http://kendo.cdn.telerik.com/2017.3.913/styles/kendo.common.min.css" />
        <link rel="stylesheet" href="http://kendo.cdn.telerik.com/2017.3.913/styles/kendo.default.min.css" />
        <script src="http://kendo.cdn.telerik.com/2017.3.913/js/jquery.min.js"></script>
        <script src="http://kendo.cdn.telerik.com/2017.3.913/js/kendo.all.min.js"></script>
        <script>
            $( document ).ready(function() {
                $.get("../Controllers/get.php?action=viewCurrentRanking",
                    function(data){
                        if (data["success"]) {
                            var ranking = data["ranking"];
                            for(var i = 0; i < ranking.length; i++) {
                                var poule = ranking[i];
                                $(".ranking").append("<div id='" + poule.id + "' ><div class='wedstrijden'></div><div class='stand'></div></div>");
                                $(kendo.format(".ranking #{0} .wedstrijden", poule.id)).kendoGrid({
                                    dataSource: {
                                        data: poule.wedstrijden,
                                    },
                                    columns: [
                                        {
                                            field: "spelerThuis_naam",
                                            template: "#: spelerThuis_voornaam # #: spelerThuis_naam # (#: spelerThuis_handicap#)",
                                            title: "#1"
                                        },
                                        {
                                            field: "spelerUit_naam",
                                            template: "#: spelerUit_voornaam # #: spelerUit_naam # (#: spelerUit_handicap#)",
                                            title: "#2"
                                        },
                                        {
                                            field: "spelerThuis_set1",
                                            template: "# if (spelerThuis_set1 > 0) { # #:spelerThuis_set1 # - #:spelerUit_set1 # " +
                                             "#:spelerThuis_set2 # - #:spelerUit_set2 # "+ 
                                             "# if(spelerThuis_set3 > 0) { # #:spelerThuis_set3 # - #:spelerUit_set3 # # }  # " + "# } else {#  # } #",
                                            title: "Uitslag"
                                        },
                                        {
                                            field: "ingevuld_op",
                                            title: "Datum"
                                        },
                                    ]
                                })

                                $(kendo.format(".ranking #{0} .stand", poule.id)).kendoGrid({
                                    dataSource: {
                                        data: poule.spelers,
                                        schema: {
                                            parse: function(response){
                                                for(var i = 0; i < response.length; i++){
                                                    response[i].punten_saldo = response[i].punten_gewonnen - response[i].punten_verloren;
                                                }
                                                return response;
                                            }
                                        },
                                        sort: [{
                                            field: "punten",
                                            dir: "desc"
                                        },
                                        {
                                            field: "punten_saldo",
                                            dir: "desc"
                                        }
                                        ]
                                    },
                                    columns: [
                                        {
                                            field: "naam",
                                            template: "#: voornaam # #: naam #",
                                            title: "Speler"
                                        },
                                        {
                                            field: "matchen_gespeeld",
                                            title: "Gespeeld"
                                        },
                                        {
                                            field: "matchen_gewonnen",
                                            title: "Gewonnen"
                                        },
                                        {
                                            field: "matchen_verloren",
                                            title: "Verloren"
                                        },
                                        {
                                            field: "punten_gewonnen",
                                            title: "Punten gemaakt"
                                        },
                                        {
                                            field: "punten_verloren",
                                            title: "Punten tegen"
                                        },
                                        {
                                            field: "punten_saldo",
                                            title: "Saldo"
                                        },
                                        {
                                            field: "punten",
                                            title: "Score"
                                        },                                                                                                                       
                                    ]

                                })

                            }
                        }
                    },
                    "json");
            });
        </script>
    </head>
    <body>    
    <div class="ranking">

    </div>
    </body>
    </html>